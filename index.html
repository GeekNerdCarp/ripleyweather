<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Ripley Weather • Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  :root{
    --bg-top:#003b6f; --bg-bottom:#000b1f; --panel:#002242; --bevel:#005d99; --shadow:#001326;
    --headline:#0077b8; --headline-text:#fffd74; --body:#eaf5ff; --muted:#c6d6ea;
    --link:#8bd0ff; --link-hover:#bdf0ff; --line:#0a3d66; --chip:#00a0a0;
    --text-secondary:#9ab6d1; --card-border:#004c80; --accent-color:#8bd0ff;
  }
  *{box-sizing:border-box} html,body{height:100%}
  body{margin:0;font-family:"Trebuchet MS",Verdana,Arial,sans-serif;color:var(--body);
       background:linear-gradient(to bottom,var(--bg-top),var(--bg-bottom) 70%);display:flex;flex-direction:column;min-height:100vh}

  header.mast{position:fixed;top:0;left:0;right:0;z-index:50;
    background:linear-gradient(to bottom,#005aa3,#003b6f);
    border-bottom:4px solid #012a4a;box-shadow:0 8px 0 var(--shadow);
    padding:10px 16px;display:flex;align-items:center;gap:16px;justify-content:space-between}
  .brand{display:flex;align-items:center;gap:12px;font-weight:800;text-transform:uppercase}
  .logo{width:36px;height:36px;border-radius:6px;background:linear-gradient(135deg,#009ad6,#005aa3);
    box-shadow:inset 0 0 0 3px #013e6b,inset 0 0 10px rgba(255,255,255,.15);
    display:grid;place-items:center;color:#ffff9e}

  .wrap{display:flex;gap:16px;width:100%;padding-top:68px;flex:1}

  nav.toc{width:260px;min-width:240px;position:sticky;top:74px;height:calc(100vh - 78px);overflow:auto;padding:10px 12px 18px;
    background:linear-gradient(to bottom,#012a4a,#001a33);border-right:4px solid #012a4a;box-shadow:inset -6px 0 0 var(--shadow)}
  .toc h3{margin:14px 8px 6px;font-size:.85rem;color:#cfeaff;letter-spacing:.08em;text-transform:uppercase;opacity:.9}
  .toc a{display:block;margin:4px 6px;padding:7px 10px;color:var(--body);text-decoration:none;font-size:.95rem;
    background:linear-gradient(to bottom,#00325d,#002242);border:2px solid #004c80;border-right-color:#0068b3;border-bottom-color:#0068b3;
    box-shadow:3px 3px 0 #00152a;border-radius:2px}
  .toc a:hover{color:var(--link-hover);transform:translateY(-1px)}

  main.content{flex:1;padding:18px 18px 40px 6px;max-width:1200px;margin:0 auto}
  section.card{background:linear-gradient(to bottom,#002e59,#002242);border:3px solid var(--bevel);
    border-right-color:#0092e0;border-bottom-color:#0092e0;box-shadow:6px 6px 0 var(--shadow);
    margin:16px 6px;padding:12px 14px}
  .bar{margin:-12px -14px 12px;padding:8px 12px;background:linear-gradient(to bottom,#0077b8,#005a8d);color:var(--headline-text);
    border-bottom:3px solid #003a63;font-weight:800;text-transform:uppercase;letter-spacing:.03em;display:flex;align-items:center;gap:10px}
  .muted{color:var(--muted)} a{color:var(--link)} a:hover{color:var(--link-hover);text-decoration:underline}

  table{width:100%;border-collapse:collapse;background:#001e38;border:2px solid #004c80}
  thead th{background:#013e6b;color:#fffbd1;padding:9px 10px;text-transform:uppercase;letter-spacing:.03em;border-bottom:2px solid #00609e;font-size:.92rem}
  td{padding:9px 10px;border-bottom:1px solid #03365c}
  tr:nth-child(even) td{background:#002442}

  @media(max-width:1100px){nav.toc{display:none}.wrap{padding-top:72px}.bar{font-size:.95rem}}

  footer{margin-top:2rem; padding:1rem; font-size:0.85rem; color:var(--text-secondary);
         border-top:1px solid var(--card-border); text-align:center}
  footer ul{list-style:none; padding:0; margin:0; line-height:1.6}
</style>
</head>
<body>
  <header class="mast">
    <div class="brand">
      <div class="logo"><strong>WX</strong></div>
      <div>Ripley Weather • <span style="opacity:.85;">Local on the ~8s</span></div>
    </div>
    <div id="runStamp" class="muted">Loading…</div>
  </header>

  <div class="wrap">
    <nav class="toc">
      <h3>Forecast</h3>
      <a href="#quick">🔎 Quick Look</a>
      <a href="#cards">📋 Key Cards</a>
      <a href="#afd">📝 AFD (External)</a>
      <a href="#seven">📆 7-Day</a>
      <a href="#dayplanner">🕒 24-Hour Planner</a>
      <h3>Storm Outlook</h3>
      <a href="#trends">📈 Trends & Diagnostics</a>
      <a href="#severe">⛈ Severe Weather</a>
      <a href="#radar">🛰 Radar & Satellite</a>
      <a href="#lightning">⚡ Lightning</a>
      <h3>Impacts</h3>
      <a href="#alerts">⚠️ Alerts</a>
      <a href="#health">🌬 Air & Health</a>
      <a href="#local">🏫 Local Impacts</a>
      <a href="#rivers">🌊 Rivers & Streams</a>
      <h3>Climate & Sky</h3>
      <a href="#records">📊 Climatology</a>
      <a href="#astro">🌌 Astronomy</a>
      <h3>Summary</h3>
      <a href="#bottom">✅ Bottom Line</a>
    </nav>

    <main class="content">
      <h1 id="runTitle" style="margin:0 6px 6px;font-size:1.4rem;">Ripley Weather</h1>
      <section id="quick" class="card"><div class="bar">🔎 Quick Look</div><div id="quickHtml">Loading…</div></section>
      <section id="cards" class="card"><div class="bar">📋 Key Items</div><div id="cardsHtml">Loading…</div></section>
      <section id="afd" class="card"><div class="bar">📝 Area Forecast Discussion</div><p class="muted">Full text hosted by weather.gov</p><p><a id="afdLink" href="#" target="_blank" rel="noopener">Open NWS ILN AFD</a></p></section>
      <section id="seven" class="card"><div class="bar">📆 7-Day Outlook</div><div id="sevenHtml">Loading…</div></section>
      <section id="dayplanner" class="card"><div class="bar">🕒 24-Hour Planner</div><div id="plannerHtml">Loading…</div></section>
      <section id="trends" class="card"><div class="bar">📈 Trends & Diagnostics</div><div id="trendsHtml">Loading…</div></section>
      <section id="severe" class="card"><div class="bar">⛈ Severe Weather Diagnostics</div><div id="severeHtml">Loading…</div></section>
      <section id="radar" class="card"><div class="bar">🛰 Radar & Satellite</div><div id="radarHtml">Loading…</div></section>
      <section id="lightning" class="card"><div class="bar">⚡ Lightning Summary</div><div id="lightningHtml">Loading…</div></section>
      <section id="alerts" class="card"><div class="bar">⚠️ Alerts & Hazards</div><div id="alertsHtml">Loading…</div></section>
      <section id="health" class="card"><div class="bar">🌬 Air & Health</div><div id="airHtml">Loading…</div></section>
      <section id="local" class="card"><div class="bar">🏫 Local Impacts</div><div id="localHtml">Loading…</div></section>
      <section id="rivers" class="card"><div class="bar">🌊 Rivers & Streams</div><div id="riversHtml">Loading…</div></section>
      <section id="records" class="card"><div class="bar">📊 Climatology & Records</div><div id="recordsHtml">Loading…</div></section>
      <section id="astro" class="card"><div class="bar">🌌 Astronomy & Skywatch</div><div id="astroHtml">Loading…</div></section>
      <section id="bottom" class="card"><div class="bar">✅ Bottom Line</div><div id="bottomHtml">Loading…</div></section>
    </main>
  </div>

  <footer>
    <p><strong>Created by Matthew Carpenter</strong> — 
      <a href="mailto:matthew@carpsemail.com" style="color:var(--accent-color); text-decoration:none;">
        matthew@carpsemail.com
      </a>
    </p>
    <p><em>Data Sources:</em></p>
    <ul>
      <li>🌐 NOAA / NWS ILN — 7-Day Forecast, Alerts, AFD</li>
      <li>🌤️ Open-Meteo — Backup Forecast & Astronomy</li>
      <li>🛰️ NWS / NOAA APIs — Radar, Satellite, Rivers & Climatology</li>
      <li>⚡ LightningMaps.org — Real-time Lightning</li>
      <li>🚀 NASA / Heavens Above — ISS & Astronomy Events</li>
    </ul>
  </footer>

  <script>
    const EXEC_URL = 'https://script.google.com/macros/s/AKfycbxEHXreFLXPTRzpnbU4Zzhz09iLXD9TyzxSyeTFfz6vzXLXzJdHcisLpHEHKH3U35K36w/exec';

    (function loadJSONP() {
      const s = document.createElement('script');
      const ts = Date.now();
      s.src = `${EXEC_URL}?format=jsonp&callback=renderReport&t=${ts}`;
      s.defer = true;
      document.head.appendChild(s);
    })();

    function renderReport(report) {
      document.title = report.meta.runTitle || 'Ripley Weather • Dashboard';
      document.getElementById('runTitle').textContent = report.meta.runTitle || 'Ripley Weather';
      document.getElementById('runStamp').textContent = `${report.meta.runTime} • #${report.meta.totalToday}`;
      document.getElementById('quickHtml').innerHTML     = report.quick;
      document.getElementById('cardsHtml').innerHTML     = report.cards;
      document.getElementById('sevenHtml').innerHTML     = report.sevenDay;
      document.getElementById('plannerHtml').innerHTML   = report.hourly;
      document.getElementById('trendsHtml').innerHTML    = report.trends;
      document.getElementById('severeHtml').innerHTML    = report.severe;
      document.getElementById('radarHtml').innerHTML     = report.radar;
      document.getElementById('lightningHtml').innerHTML = report.lightning;
      document.getElementById('alertsHtml').innerHTML    = report.alerts;
      document.getElementById('airHtml').innerHTML       = report.air;
      document.getElementById('localHtml').innerHTML     = report.local;
      document.getElementById('riversHtml').innerHTML    = report.rivers;
      document.getElementById('recordsHtml').innerHTML   = report.records;
      document.getElementById('astroHtml').innerHTML     = report.astro;
      document.getElementById('bottomHtml').innerHTML    = report.bottom;
      const afd = document.getElementById('afdLink');
      if (afd && report.afdLink) afd.href = report.afdLink;
    }
  </script>
</body>
</html>
