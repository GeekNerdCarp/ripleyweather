<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>WX Payload Debug (Stable)</title>
<style>
  body{font:14px/1.5 ui-monospace,Menlo,Consolas,monospace;background:#0b1220;color:#e9f3ff;margin:0;padding:16px}
  h1{font-size:18px;margin:0 0 12px}
  .row{display:grid;grid-template-columns:200px 1fr;gap:10px;border-bottom:1px solid #21304b;padding:10px 0}
  .k{color:#9ed4ff}
  pre{margin:0;white-space:pre-wrap;word-break:break-word;background:#0f1a2d;padding:10px;border-radius:8px}
  .bad{background:#2a0d12}
  .ok{background:#0d2416}
  .muted{color:#a7b6cc}
  .head{display:flex;justify-content:space-between;align-items:center;gap:8px}
  button{background:#295b9d;color:#fff;border:0;padding:6px 10px;border-radius:8px;cursor:pointer}
</style>
</head>
<body>
<div class="head">
  <h1>WX Payload Debug (Stable)</h1>
  <button id="refresh">Fetch</button>
</div>
<div class="muted" id="info">Waiting…</div>
<div id="out"></div>

<script>
  const EXEC_URL = 'https://script.google.com/macros/s/AKfycbxEHXreFLXPTRzpnbU4Zzhz09iLXD9TyzxSyeTFfz6vzXLXzJdHcisLpHEHKH3U35K36w/exec';
  const keys = ['quick','cards','sevenDay','hourly','trends','severe','radar','lightning','alerts','air','local','rivers','records','astro','bottom','alertsActive','afdLink','meta'];

  function row(label,val){
    const ok = val ? 'ok':'bad';
    const pre = typeof val==='object' ? JSON.stringify(val,null,2) : (val||'');
    return `<div class="row"><div class="k">${label}</div><pre class="${ok}">${pre || '(empty)'}</pre></div>`;
  }
  function render(r){
    document.getElementById('info').textContent = (r?.meta?.runTitle||'')+' — '+(r?.meta?.runTime||'');
    document.getElementById('out').innerHTML = keys.map(k=>row(k,r?.[k])).join('');
  }
  function load(){
    const cb = 'cb_'+Date.now();
    window[cb] = (data)=>{ render(data); delete window[cb]; };
    const s = document.createElement('script');
    s.src = `${EXEC_URL}?format=jsonp&callback=${cb}&t=${Date.now()}`;
    document.head.appendChild(s);
  }
  document.getElementById('refresh').addEventListener('click', load);
  load();
</script>
</body>
</html>
